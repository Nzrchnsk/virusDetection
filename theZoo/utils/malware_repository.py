import sqlite3
import sys


class MalwareRepository:

    def __init__(self, db_path):
        try:
            self.con = sqlite3.connect(db_path)
            self.cur = self.con.cursor()
        except sqlite3.Error as e:
            print("An error occurred:", e.args[0])
            sys.exit()

    def get_win_mal(self):
        self.cur.execute(
            "select * FROM Malwares m where m.PLATFORM in ('win32', 'win64', 'win32,win64', 'win32, win64') and m.TAGS != 'Source'")
        rows = self.cur.fetchall()
        return rows
